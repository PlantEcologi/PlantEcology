<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Plant Ecology UCT - BIO3018F Ecology &amp; Evolution - 2023 Practical</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/icon.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-27D8KSBZ2E"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-27D8KSBZ2E', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Plant Ecology UCT - BIO3018F Ecology &amp; Evolution - 2023 Practical">
<meta property="og:description" content="">
<meta property="og:image" content="https://plantecolo.gy/teaching/bio3018f/2023/images/recoverycurve.png">
<meta property="og:site-name" content="Plant Ecology UCT">
<meta property="og:image:height" content="547">
<meta property="og:image:width" content="1500">
<meta name="twitter:title" content="Plant Ecology UCT - BIO3018F Ecology &amp; Evolution - 2023 Practical">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://plantecolo.gy/teaching/bio3018f/2023/images/recoverycurve.png">
<meta name="twitter:image-height" content="547">
<meta name="twitter:image-width" content="1500">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Plant Ecology UCT</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/index.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../teaching/index.html" rel="" target="">
 <span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../lab/index.html" rel="" target="">
 <span class="menu-text">Lab</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/PlantEcologi" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/JasperSlingsby" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://scholar.google.com/citations?user=ZjBauSkAAAAJ&amp;hl=en" rel="" target=""><i class="bi bi-mortarboard-fill" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#field-methods" id="toc-field-methods" class="nav-link" data-scroll-target="#field-methods">Field Methods</a></li>
  <li><a href="#ecosystem-function" id="toc-ecosystem-function" class="nav-link" data-scroll-target="#ecosystem-function">Ecosystem function</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#analyses" id="toc-analyses" class="nav-link" data-scroll-target="#analyses">Analyses</a>
  <ul class="collapse">
  <li><a href="#species-alpha-diversity" id="toc-species-alpha-diversity" class="nav-link" data-scroll-target="#species-alpha-diversity">Species Alpha Diversity</a>
  <ul class="collapse">
  <li><a href="#sites" id="toc-sites" class="nav-link" data-scroll-target="#sites">Sites</a></li>
  <li><a href="#point-locations" id="toc-point-locations" class="nav-link" data-scroll-target="#point-locations">Point locations</a></li>
  </ul></li>
  <li><a href="#species-beta-diversity" id="toc-species-beta-diversity" class="nav-link" data-scroll-target="#species-beta-diversity">Species Beta Diversity</a>
  <ul class="collapse">
  <li><a href="#sites-1" id="toc-sites-1" class="nav-link" data-scroll-target="#sites-1">Sites</a></li>
  <li><a href="#point-locations-1" id="toc-point-locations-1" class="nav-link" data-scroll-target="#point-locations-1">Point locations</a></li>
  </ul></li>
  <li><a href="#trait-means" id="toc-trait-means" class="nav-link" data-scroll-target="#trait-means">Trait means</a></li>
  <li><a href="#functional-alpha-diversity" id="toc-functional-alpha-diversity" class="nav-link" data-scroll-target="#functional-alpha-diversity">Functional Alpha Diversity</a>
  <ul class="collapse">
  <li><a href="#fd-by-site" id="toc-fd-by-site" class="nav-link" data-scroll-target="#fd-by-site">FD by Site</a></li>
  <li><a href="#fd-by-point-location" id="toc-fd-by-point-location" class="nav-link" data-scroll-target="#fd-by-point-location">FD by point location:</a></li>
  </ul></li>
  <li><a href="#functional-beta-diversity" id="toc-functional-beta-diversity" class="nav-link" data-scroll-target="#functional-beta-diversity">Functional Beta Diversity</a></li>
  <li><a href="#environment" id="toc-environment" class="nav-link" data-scroll-target="#environment">Environment</a></li>
  <li><a href="#ecosystem-function-1" id="toc-ecosystem-function-1" class="nav-link" data-scroll-target="#ecosystem-function-1">Ecosystem function</a></li>
  </ul></li>
  <li><a href="#statistical-tests" id="toc-statistical-tests" class="nav-link" data-scroll-target="#statistical-tests">Statistical tests</a>
  <ul class="collapse">
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting">Plotting</a></li>
  <li><a href="#test-for-significant-difference-among-sites" id="toc-test-for-significant-difference-among-sites" class="nav-link" data-scroll-target="#test-for-significant-difference-among-sites">Test for significant difference among sites</a></li>
  <li><a href="#correlations" id="toc-correlations" class="nav-link" data-scroll-target="#correlations">Correlations</a></li>
  <li><a href="#test-relationship-among-distance-matrices" id="toc-test-relationship-among-distance-matrices" class="nav-link" data-scroll-target="#test-relationship-among-distance-matrices">Test relationship among distance matrices</a></li>
  <li><a href="#testing-for-grouping-of-similarity-among-points-within-sites-using-analysis-of-variance-using-distance-matrices-adonis" id="toc-testing-for-grouping-of-similarity-among-points-within-sites-using-analysis-of-variance-using-distance-matrices-adonis" class="nav-link" data-scroll-target="#testing-for-grouping-of-similarity-among-points-within-sites-using-analysis-of-variance-using-distance-matrices-adonis">Testing for grouping of similarity among points within sites using analysis of variance using distance matrices (ADONIS)</a></li>
  </ul></li>
  <li><a href="#references-papers-accessible-at-this-link" id="toc-references-papers-accessible-at-this-link" class="nav-link" data-scroll-target="#references-papers-accessible-at-this-link">References (papers accessible at this link)</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/PlantEcologi/PlantEcology/edit/main/teaching/bio3018f/2023/index.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/PlantEcologi/PlantEcology/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">BIO3018F Ecology &amp; Evolution - 2023 Practical</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>


<div class="no-row-height column-margin column-container"><div class="">
<p><img src="Hypodiscus aristatus.jpg" class="img-fluid"></p>
</div></div><p>This section covers the analysis and write-up of the practical we did on <em>Biodiversity and Ecosystem Function in the Cape Floristic Region</em>.</p>
<p>I provide R code below, which you can run on your own laptops if you have R installed (and it helps to have RStudio or similar). Alternatively, you can sign up for an account on <a href="https://posit.cloud/">Posit Cloud</a>, which allows you to run the code on a cloud machine from your internet browser. Make sure to use your university email address as it allows you more free resources.</p>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Our understanding of and approach to studying the relationship between biodiversity and ecosystem function (B-EF) has evolved over the past few decades (Figure 1; van der Plas 2019). The historical view was one of biodiversity as the response variable, being determined by environmental and anthropogenic factors, with little feedback to ecosystem function. In the early 1990s, this shifted (and perhaps overcompensated) to focus on the causal effects of variation in biodiversity on ecosystem functioning, with little emphasis on the role of environmental variation. More recently, there is recognition that biodiversity both responds to the environment and partly drives ecosystem function in concert with environmental variation. The current focus of most B-EF research is on the relative importance of abiotic drivers (natural and anthropogenic) versus biotic variation in determining various ecosystem functions.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/vanderplas2019_BEF.jpg" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">(from van der Plas 2019)</figcaption>
</figure>
</div>
</div>
</div>
<p>The Cape Floristic Region (CFR) of South Africa is one of the most botanically diverse areas on the planet. The indigenous flora of the CFR has several components with different evolutionary and biogeographic origins (Figure 2; Bergh et al.&nbsp;2014), and distinct differences in a range of ecosystem functions. The CFR also has a long history of global change impacts, from direct anthropogenic disturbance (e.g.&nbsp;land use / land cover) to the introduction of invasive alien species. This provides a range of highly varied natural and modified ecosystem types within close proximity, that often share or contrast in their biotic composition (species, functional and phylogenetic diversity) and abiotic conditions - climate, soils and disturbance regimes (fire, herbivory).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/bergh2014.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Ordination of genus-level floristic similarities of GCFR vegetation units sensu Mucina and Rutherford (2006), as inferred on the basis of the ‘important species’ lists provided in The vegetation of South Africa, Lesotho and Swaziland (Mucina and Rutherford 2006). Figure from Bergh et al.&nbsp;2014.</figcaption>
</figure>
</div>
</div>
</div>
<p>In this practical, we will investigate the Biodiversity-Ecosystem Function paradigms in Figure 1 by investigating the relationships among a set of ecosystem types using measures of biodiversity (species and functional <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> diversity) and exploring their relationship to various environmental conditions and a set of metrics of ecosystem function derived from satellite timeseries.</p>
<p>The questions are:</p>
<ul>
<li><p>Does the variation in environmental conditions explain the observed variation in biodiversity (species, functional and phylogenetic <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> diversity)?</p></li>
<li><p>To what degree does the variation in functional and phylogenetic diversity explain the observed variation in our measures of ecosystem function?</p></li>
<li><p>What is the relative role of the environment versus biodiversity in determining the observed variation in ecosystem function?</p></li>
</ul>
<p>Finally, consider this practical a descriptive study. In your discussion, describe a follow-up study that you would perform to discern cause from correlation and partition the relative influence of environmental conditions versus biodiversity on our measures of ecosystem function.</p>
<p><br></p>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<section id="field-methods" class="level2">
<h2 class="anchored" data-anchor-id="field-methods">Field Methods</h2>
<p>The sites were selected to represent contrasting vegetation, differing either in their abiotic template or degree to which they have been modified, but to all be the same (or similar) post-fire age (time since last fire). We will split into 4 teams of 2 or 3. Each pair will survey a point location (towards the corners) within the 250 by 250m MODIS satellite mission pixel that makes up each site.</p>
<p>Each team will need:</p>
<ul>
<li>One or more smartphones</li>
<li>2 x 10m measuring tape (or longer)</li>
<li>1 x clipboard, paper and pen or pencil</li>
<li>1 x densiometer</li>
<li>1 x metre rule</li>
<li>1 x Vernier calipers</li>
<li>8 x large plastic bags for carrying soil and plant samples for each point location</li>
<li>8 x soil sample bags</li>
<li>2 x masking tape</li>
<li>2 x marker pen</li>
</ul>
<p>At each site, navigate to your team’s point location, lay out the two tapes at 90 degrees, crossing at 3.2m and ending at 6.4m. Consider this your guide for a 3.2m radius (~20m2) circle. Within the circle we will measure:</p>
<ol type="1">
<li><em>Environmental conditions:</em></li>
</ol>
<ul>
<li><p>Estimate % projected cover (think the area you would see from above) bare soil</p></li>
<li><p><del>Take a densiometer reading at ground level. To do this, hold the densiometer level on the soil surface. Pick a spot close to the centre, but try not to pick an obviously open (or closed) patch, it should be representative of the location. To take a reading, split each square into quarters and score them for the amount of light visible - a value from 0 (complete canopy cover) to 4 (no vegetation visible)</del> - <del>counting up these values for all 24 squares (to a maximum of 96), and write this down. We will convert this to canopy cover later, applying the formula</del> <span class="math inline">\(100 - 1.04*X\)</span>, <del>where</del> <span class="math inline">\(X\)</span> <del>is your reading.</del></p></li>
<li><p><del>Take a <strong>soil sample</strong> (we are going to pool the 4 samples per site). These we will process for soil pH.</del></p></li>
<li><p>Do a <strong>dung count</strong>, scoring dung for the point location by the number of quarters where you find dung (i.e.&nbsp;a single score from 0-4 for the point location). Try to avoid scoring obvious single scat (“dung creation”) events in more than one quadrat, unless it’s an impressive pile.</p></li>
<li><p>Take a few notes (and photos) on any other features that you think may be important or interesting (slope, rockiness, whatever).</p></li>
</ul>
<p><br></p>
<ol start="2" type="1">
<li><em>Diversity sampling:</em></li>
</ol>
<ul>
<li><p>First, make sure your smartphone is fully charged and set to record GPS location with your photographs!</p></li>
<li><p>With your team, decide on which are the top 5 species by % projected cover. If your site is dominated by fewer than 5 species, count up as many species as make up 80% of the vegetation.</p>
<ul>
<li><p>Take diagnostic photos for the 5 species (habit (whole plant), leaf, base, flowers and/or fruits).</p></li>
<li><p>For each of three individuals of your 5 target species, measure the height and canopy diameter in 2 dimensions (perpendicular). Then collect shoots for measuring leaf traits back at the lab (leaf length, width, area and dry mass). You need to collect enough to be able to process at least 3 leaves per sample (more if the species has tiny leaves). Mark each sample with masking tape and put in sample bag for the site.</p></li>
</ul></li>
<li><p>Finally, set a timer and take as many photos of new species (other than your 5 target species) within or near your plot as you can before the alarm goes off. Make sure to take a photo of your site label on your sample bag between sites so you know which photos were collected at which sites. When we get back to base you will upload the photos to folders in the intranet labeled by site.</p></li>
</ul>
</section>
<section id="ecosystem-function" class="level2">
<h2 class="anchored" data-anchor-id="ecosystem-function">Ecosystem function</h2>
<p>To explore ecosystem function we looked at the 20-year time series of the Normalized Difference Vegetation Index (NDVI) recorded by the MODIS satellite mission. From these we used the post-fire recovery trajectory modelling framework developed by Wilson et al.&nbsp;(2015) to derive estimates of a series of parameters that we will use as our measures of ecosystem function. These are illustrated in the figure and explained below:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/recoverycurve.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Stylized postfire recovery curve from Slingsby et al.&nbsp;(2020).</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li>alpha = starting NDVI after a fire (lower stippled line )</li>
<li>gamma = the difference between alpha and the asymptote of NDVI (i.e.&nbsp;alpha + gamma = estimated steady long-term NDVI (upper stippled line))</li>
<li>lambda = 1/recovery rate after fire (i.e.&nbsp;the smaller the value the faster the rate of recovery)</li>
<li>A = the magnitude of seasonality (the absolute value indicates the magnitude, ignore the sign (+/-) for now)</li>
<li>phi = the timing of seasonality</li>
</ul>
</section>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<p>Ok, now you need the data! These can be downloaded <a href="https://drive.google.com/drive/folders/1iaxXmeE_ny7rIy4NFCwM0wqDrYuc88dt?usp=sharing">here</a>.</p>
<ul>
<li>Download it and put it somewhere sensible</li>
<li>If you downloaded them as a Zip file, Unzip it</li>
<li>Wherever I read in data in the code below you will need to change the file path to match where you have it on your computer. e.g.&nbsp;where I say:
<ul>
<li><code>sdat &lt;- read_xlsx("data/pracdatasheet2023.xlsx", sheet = "Species2023")</code> you need to change it to match your file path, like:</li>
<li><code>sdat &lt;- read_xlsx("C:\\Documents\\bio3018f_pracdata\\pracdatasheet2023.xlsx", sheet = "Species2023")</code></li>
<li>NOTE that Windows wants backslashes for some reason!</li>
</ul></li>
</ul>
</section>
<section id="analyses" class="level1">
<h1>Analyses</h1>
<p>Here I work through a series of analyses, providing R code to look at measures of biodiversity (species and functional), environment and ecosystem function. I then demonstrate a few statistical tests. Some of the results you can use as is. Others you should fiddle with the code to address the questions you want to ask.</p>
<section id="species-alpha-diversity" class="level2">
<h2 class="anchored" data-anchor-id="species-alpha-diversity">Species Alpha Diversity</h2>
<p>For this I have just taken the count of species encountered at each point during our rapid photographic surveys, and the aggregated set of unique species for each site (i.e.&nbsp;no rarefaction etc).</p>
<blockquote class="blockquote">
<p><em>Discussion hint: Do you think this is an issue for the method we used? Are there any biases we may have introduced? Justify your answer.</em></p>
</blockquote>
<section id="sites" class="level3">
<h3 class="anchored" data-anchor-id="sites">Sites</h3>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call libraries (you may need to uncomment and run the first line to install them)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(c("tidyverse", "readxl", "knitr", "FSA", "picante", "sf", "MODISTools"))</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FSA)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(picante)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>sdat <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/pracdatasheet2023.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Species2023"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Select indigenous or invasive species only</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#sdat &lt;- sdat %&gt;% filter(is.na(Alien))</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#sdat &lt;- sdat %&gt;% filter(Alien == 1)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Get list of species by site</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#dat %&gt;% select(Site,FullName) %&gt;% unique() %&gt;% View()</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Get count of species by site</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>site_SD <span class="ot">&lt;-</span> sdat <span class="sc">%&gt;%</span> </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter(Point == "SE") %&gt;% # If you wnt to select only one corner - SE in this case</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, FullName) <span class="sc">%&gt;%</span> </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Species Number</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>())</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Present as a table</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(site_SD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Site</th>
<th style="text-align: right;">Species Number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone</td>
<td style="text-align: right;">24</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="point-locations" class="level3">
<h3 class="anchored" data-anchor-id="point-locations">Point locations</h3>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Get count of species by point</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>point_SD <span class="ot">&lt;-</span> sdat <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PointName =</span> <span class="fu">paste</span>(Site, Point, <span class="at">sep =</span> <span class="st">"_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PointName, FullName) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PointName) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Species Number</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>())</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Present as a table</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(point_SD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">PointName</th>
<th style="text-align: right;">Species Number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass_NE</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_NW</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grass_SE</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_SW</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_NE</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_NW</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_SE</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_SW</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_NE</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_NW</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_SE</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_SW</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_NE</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_NW</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_SE</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_SW</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_NE</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_NW</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_SE</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_SW</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="species-beta-diversity" class="level2">
<h2 class="anchored" data-anchor-id="species-beta-diversity">Species Beta Diversity</h2>
<p>Here I calculate species beta diversity using Sorenson’s distance.</p>
<blockquote class="blockquote">
<p><em>Discussion hint: Why can’t we do Bray-Curtis? What would we gain if we could?</em></p>
</blockquote>
<section id="sites-1" class="level3">
<h3 class="anchored" data-anchor-id="sites-1">Sites</h3>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a community data matrix</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>site_comm <span class="ot">&lt;-</span> sdat <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Abundance =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, FullName, Abundance) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> FullName, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Abundance,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># This requires some tomfoolery to set the row names from the first column to get the community data into the desired format for the designdist() function</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>site_comm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(site_comm))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(site_comm) <span class="ot">&lt;-</span> site_comm[,<span class="dv">1</span>]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>site_comm <span class="ot">&lt;-</span> site_comm[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Sorenson's distances</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>site_BD <span class="ot">&lt;-</span> <span class="fu">designdist</span>(site_comm, <span class="at">method =</span> <span class="st">"(A+B-2*J)/(A+B)"</span>, <span class="at">terms =</span> <span class="st">"binary"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># some tomfoolery to present it nicely... (kable() doesn't like class "dist" - i.e. distance objects)</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>msite_BD <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(site_BD)) <span class="co"># make it a rectangular table</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>msite_BD[<span class="fu">upper.tri</span>(msite_BD, <span class="at">diag =</span> T)] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># set the top-right to "NA"</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>) <span class="co"># set the kable() table printing function to make NA values blank</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Present as a table</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(msite_BD, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">grass</th>
<th style="text-align: right;">invasion</th>
<th style="text-align: right;">renosterveld</th>
<th style="text-align: right;">sand</th>
<th style="text-align: right;">sandstone</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion</td>
<td style="text-align: right;">0.938</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">0.941</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sand</td>
<td style="text-align: right;">0.952</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.955</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone</td>
<td style="text-align: right;">0.951</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.953</td>
<td style="text-align: right;">0.551</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="point-locations-1" class="level3">
<h3 class="anchored" data-anchor-id="point-locations-1">Point locations</h3>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a community data matrix</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>point_comm <span class="ot">&lt;-</span> sdat <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PointName =</span> <span class="fu">paste</span>(Site, Point, <span class="at">sep =</span> <span class="st">"_"</span>), <span class="at">Abundance =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PointName, FullName, Abundance) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> FullName, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Abundance,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># tomfoolery to set the row names from the first column to get the community data into the desired format for the designdist function</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>point_comm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(point_comm))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(point_comm) <span class="ot">&lt;-</span> point_comm[,<span class="dv">1</span>]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>point_comm <span class="ot">&lt;-</span> point_comm[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Sorenson's distances</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>point_BD <span class="ot">&lt;-</span> <span class="fu">designdist</span>(point_comm, <span class="at">method =</span> <span class="st">"(A+B-2*J)/(A+B)"</span>, <span class="at">terms =</span> <span class="st">"binary"</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># some tomfoolery to present it nicely... (kable() doesn't like class "dist" - i.e. distance objects)</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>mpoint_BD <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(point_BD)) <span class="co"># make it a rectangular table</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>mpoint_BD[<span class="fu">upper.tri</span>(mpoint_BD, <span class="at">diag =</span> T)] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># set the top-right to "NA"</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>) <span class="co"># set the kable() table printing function to make NA values blank</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Present as a table</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mpoint_BD, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">grass_NE</th>
<th style="text-align: right;">grass_NW</th>
<th style="text-align: right;">grass_SE</th>
<th style="text-align: right;">grass_SW</th>
<th style="text-align: right;">invasion_NE</th>
<th style="text-align: right;">invasion_NW</th>
<th style="text-align: right;">invasion_SE</th>
<th style="text-align: right;">invasion_SW</th>
<th style="text-align: right;">renosterveld_NE</th>
<th style="text-align: right;">renosterveld_NW</th>
<th style="text-align: right;">renosterveld_SE</th>
<th style="text-align: right;">renosterveld_SW</th>
<th style="text-align: right;">sand_NE</th>
<th style="text-align: right;">sand_NW</th>
<th style="text-align: right;">sand_SE</th>
<th style="text-align: right;">sand_SW</th>
<th style="text-align: right;">sandstone_NE</th>
<th style="text-align: right;">sandstone_NW</th>
<th style="text-align: right;">sandstone_SE</th>
<th style="text-align: right;">sandstone_SW</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass_NE</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_NW</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">grass_SE</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">0.600</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_SW</td>
<td style="text-align: right;">0.692</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_NE</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.895</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_NW</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_SE</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.818</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.286</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_SW</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.333</td>
<td style="text-align: right;">0.286</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_NE</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.692</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_NW</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.600</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.909</td>
<td style="text-align: right;">0.913</td>
<td style="text-align: right;">0.895</td>
<td style="text-align: right;">0.905</td>
<td style="text-align: right;">0.895</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_SE</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">0.895</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0.545</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_SW</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.538</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: right;">0.333</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_NE</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.895</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.905</td>
<td style="text-align: right;">0.909</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">0.905</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_NW</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">0.789</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.909</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.524</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_SE</td>
<td style="text-align: right;">0.909</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">0.905</td>
<td style="text-align: right;">0.926</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.917</td>
<td style="text-align: right;">0.923</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.917</td>
<td style="text-align: right;">0.935</td>
<td style="text-align: right;">0.926</td>
<td style="text-align: right;">0.917</td>
<td style="text-align: right;">0.400</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_SW</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.818</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.714</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.905</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.700</td>
<td style="text-align: right;">0.529</td>
<td style="text-align: right;">0.692</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_NE</td>
<td style="text-align: right;">0.818</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.684</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.840</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_NW</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.810</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.789</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.917</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.565</td>
<td style="text-align: right;">0.700</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.789</td>
<td style="text-align: right;">0.444</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_SE</td>
<td style="text-align: right;">0.913</td>
<td style="text-align: right;">0.923</td>
<td style="text-align: right;">0.909</td>
<td style="text-align: right;">0.929</td>
<td style="text-align: right;">0.862</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">0.938</td>
<td style="text-align: right;">0.929</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">0.714</td>
<td style="text-align: right;">0.568</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.615</td>
<td style="text-align: right;">0.467</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_SW</td>
<td style="text-align: right;">0.818</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">0.789</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0.571</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">0.538</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="trait-means" class="level2">
<h2 class="anchored" data-anchor-id="trait-means">Trait means</h2>
<p>Recall that I discussed the difference between direct trait effects and diversity effects in the lecture on Biodiversity and Ecosystem Function. Here I calculate the Community Weighted Mean (CWM) values for the traits we sampled. Note that the “weighted” indicates that the trait means are usually weighted by species abundance, cover, biomass etc. Since we only have presence/absence data wll weights will be 1.</p>
<p>Firstly, by site.</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tdat <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/pracdatasheet2023.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Traits2023"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract species trait means </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>traitspecies <span class="ot">&lt;-</span> tdat <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FullName) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">PlantHeight_cm =</span> <span class="fu">mean</span>(PlantHeight_cm, <span class="at">na.rm =</span> T), </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">LeafLength_mm =</span> <span class="fu">mean</span>(LeafLength_mm, <span class="at">na.rm =</span> T), </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">LeafDryMass_g =</span> <span class="fu">mean</span>(LeafDryMassPerLeaf_g, <span class="at">na.rm =</span> T),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">LeafMassPerLength =</span> <span class="fu">mean</span>(LeafDryMassPerLeaf_g, <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">mean</span>(LeafLength_mm, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="co"># Drop and NA entries</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get list of species by site</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>trsite <span class="ot">&lt;-</span> tdat <span class="sc">%&gt;%</span> <span class="fu">select</span>(Site, FullName) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Join list of species by site to the trait means and add column of weights</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>traitsite <span class="ot">&lt;-</span> <span class="fu">left_join</span>(trsite, traitspecies) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Weights =</span> <span class="dv">1</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating CWM </span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>sitecwm <span class="ot">&lt;-</span>   <span class="co"># New dataframe where we can inspect the result</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>traitsite <span class="sc">%&gt;%</span>   <span class="co"># First step in the next string of statements</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span>   <span class="co"># Groups the summary file by site</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(           <span class="co"># Coding for how we want our CWMs summarized</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="at">Height_cwm =</span> <span class="fu">weighted.mean</span>(PlantHeight_cm, Weights, <span class="at">na.rm =</span> T),   <span class="co"># Actual calculation of CWMs</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="at">LeafLength_cwm =</span> <span class="fu">weighted.mean</span>(LeafLength_mm, Weights, <span class="at">na.rm =</span> T),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="at">LeafDryMass_cwm =</span> <span class="fu">weighted.mean</span>(LeafDryMass_g, Weights, <span class="at">na.rm =</span> T),</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="at">LeafMassPerLength_cwm =</span> <span class="fu">weighted.mean</span>(LeafMassPerLength, Weights, <span class="at">na.rm =</span> T)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Present as a table</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(sitecwm, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 20%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Site</th>
<th style="text-align: right;">Height_cwm</th>
<th style="text-align: right;">LeafLength_cwm</th>
<th style="text-align: right;">LeafDryMass_cwm</th>
<th style="text-align: right;">LeafMassPerLength_cwm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass</td>
<td style="text-align: right;">131.843</td>
<td style="text-align: right;">10.867</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">0.016</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion</td>
<td style="text-align: right;">260.415</td>
<td style="text-align: right;">22.653</td>
<td style="text-align: right;">0.308</td>
<td style="text-align: right;">0.012</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld</td>
<td style="text-align: right;">40.000</td>
<td style="text-align: right;">15.169</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">0.005</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand</td>
<td style="text-align: right;">102.345</td>
<td style="text-align: right;">14.651</td>
<td style="text-align: right;">0.458</td>
<td style="text-align: right;">0.020</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone</td>
<td style="text-align: right;">91.787</td>
<td style="text-align: right;">96.312</td>
<td style="text-align: right;">0.469</td>
<td style="text-align: right;">0.014</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Some of these numbers look quite surprising, but you can have a look at the individual objects we created by typing them into your R console, e.g.&nbsp;<code>traitsite</code>.</p>
<p>Now, by point.</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get list of species by point</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>trpoint <span class="ot">&lt;-</span> tdat <span class="sc">%&gt;%</span> <span class="fu">select</span>(SitePoint, FullName) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Join list of species by site to the trait means and add column of weights</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>traitpoint <span class="ot">&lt;-</span> <span class="fu">left_join</span>(trpoint, traitspecies) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Weights =</span> <span class="dv">1</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating CWM </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>pointcwm <span class="ot">&lt;-</span>   <span class="co"># New dataframe where we can inspect the result</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>traitpoint <span class="sc">%&gt;%</span>   <span class="co"># First step in the next string of statements</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(SitePoint) <span class="sc">%&gt;%</span>   <span class="co"># Groups the summary file by site</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(           <span class="co"># Coding for how we want our CWMs summarized</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="at">Height_cwm =</span> <span class="fu">weighted.mean</span>(PlantHeight_cm, Weights, <span class="at">na.rm =</span> T),   <span class="co"># Actual calculation of CWMs</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="at">LeafLength_cwm =</span> <span class="fu">weighted.mean</span>(LeafLength_mm, Weights, <span class="at">na.rm =</span> T),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="at">LeafDryMass_cwm =</span> <span class="fu">weighted.mean</span>(LeafDryMass_g, Weights, <span class="at">na.rm =</span> T),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="at">LeafMassPerLength_cwm =</span> <span class="fu">weighted.mean</span>(LeafMassPerLength, Weights, <span class="at">na.rm =</span> T)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Present as a table</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(pointcwm, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">SitePoint</th>
<th style="text-align: right;">Height_cwm</th>
<th style="text-align: right;">LeafLength_cwm</th>
<th style="text-align: right;">LeafDryMass_cwm</th>
<th style="text-align: right;">LeafMassPerLength_cwm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass_NE</td>
<td style="text-align: right;">39.796</td>
<td style="text-align: right;">27.033</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_NW</td>
<td style="text-align: right;">127.522</td>
<td style="text-align: right;">15.273</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">0.011</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grass_SE</td>
<td style="text-align: right;">21.944</td>
<td style="text-align: right;">11.067</td>
<td style="text-align: right;">0.241</td>
<td style="text-align: right;">0.026</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_SW</td>
<td style="text-align: right;">176.500</td>
<td style="text-align: right;">3.100</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">0.017</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_NE</td>
<td style="text-align: right;">156.908</td>
<td style="text-align: right;">14.564</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">0.008</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_NW</td>
<td style="text-align: right;">373.100</td>
<td style="text-align: right;">54.486</td>
<td style="text-align: right;">0.715</td>
<td style="text-align: right;">0.018</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_SE</td>
<td style="text-align: right;">407.580</td>
<td style="text-align: right;">18.689</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.019</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_SW</td>
<td style="text-align: right;">342.671</td>
<td style="text-align: right;">33.138</td>
<td style="text-align: right;">0.404</td>
<td style="text-align: right;">0.014</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_NE</td>
<td style="text-align: right;">37.033</td>
<td style="text-align: right;">13.480</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_NW</td>
<td style="text-align: right;">54.956</td>
<td style="text-align: right;">14.847</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_SE</td>
<td style="text-align: right;">34.967</td>
<td style="text-align: right;">15.233</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_SW</td>
<td style="text-align: right;">47.533</td>
<td style="text-align: right;">16.927</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_NE</td>
<td style="text-align: right;">82.443</td>
<td style="text-align: right;">9.947</td>
<td style="text-align: right;">0.410</td>
<td style="text-align: right;">0.023</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_NW</td>
<td style="text-align: right;">79.527</td>
<td style="text-align: right;">10.478</td>
<td style="text-align: right;">0.421</td>
<td style="text-align: right;">0.025</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_SE</td>
<td style="text-align: right;">95.355</td>
<td style="text-align: right;">21.996</td>
<td style="text-align: right;">0.757</td>
<td style="text-align: right;">0.027</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_SW</td>
<td style="text-align: right;">127.714</td>
<td style="text-align: right;">11.937</td>
<td style="text-align: right;">0.477</td>
<td style="text-align: right;">0.030</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_NE</td>
<td style="text-align: right;">107.639</td>
<td style="text-align: right;">221.248</td>
<td style="text-align: right;">1.033</td>
<td style="text-align: right;">0.018</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_NW</td>
<td style="text-align: right;">86.976</td>
<td style="text-align: right;">146.391</td>
<td style="text-align: right;">0.100</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_SE</td>
<td style="text-align: right;">98.589</td>
<td style="text-align: right;">203.793</td>
<td style="text-align: right;">0.406</td>
<td style="text-align: right;">0.012</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_SW</td>
<td style="text-align: right;">100.989</td>
<td style="text-align: right;">20.447</td>
<td style="text-align: right;">0.686</td>
<td style="text-align: right;">0.020</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
</section>
<section id="functional-alpha-diversity" class="level2">
<h2 class="anchored" data-anchor-id="functional-alpha-diversity">Functional Alpha Diversity</h2>
<p>Here I’ve estimated Functional Diversity (FD) according to the method of Petchey and Gaston (2002) for each of the points and aggregated sites using only the dominant species for which we measured traits. To apply Petchey and Gaston’s method, we first need to estimate a functional dendrogram representing the functional similarity among species based on the traits we measured.</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract species trait means and scale them to mean = 0 and sd = 0</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> tdat <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FullName) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">PlantHeight_cm =</span> <span class="fu">mean</span>(PlantHeight_cm, <span class="at">na.rm =</span> T), </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">LeafLength_mm =</span> <span class="fu">mean</span>(LeafLength_mm, <span class="at">na.rm =</span> T), </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">LeafDryMass_g =</span> <span class="fu">mean</span>(LeafDryMassPerLeaf_g, <span class="at">na.rm =</span> T),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">LeafMassPerLength =</span> <span class="fu">mean</span>(LeafDryMassPerLeaf_g, <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">mean</span>(LeafLength_mm, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), scale)) <span class="sc">%&gt;%</span> <span class="co">#Note this line is different to "traitspecies" above</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="co"># Drop and NA entries</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the traits to create a distance matrix for the species</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>trt <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(traits[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(trt) <span class="ot">&lt;-</span> traits<span class="sc">$</span>FullName</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">dist</span>(trt)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Use this distance matrix to construct a dendrogram that represents the similarity/dissimilarity among species according to their traits</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D,<span class="st">"average"</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the dendrogram into an object of class 'phylo' (needed for the next step)</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>ptree <span class="ot">&lt;-</span> <span class="fu">as.phylo</span>(tree)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove unnecessary objects to keep the workspace tidy</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(trt, D, tree)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the tree to see the relationships among species</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ptree, <span class="at">cex =</span> <span class="fl">0.45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="fd-by-site" class="level3">
<h3 class="anchored" data-anchor-id="fd-by-site">FD by Site</h3>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a community data matrix for the sites</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>samp <span class="ot">&lt;-</span> tdat <span class="sc">%&gt;%</span>                                    <span class="co"># For sites, lumping all points together </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PointName =</span> <span class="fu">paste</span>(Site, Point, <span class="at">sep =</span> <span class="st">"_"</span>), <span class="co"># Make a new name column combining Site and Point</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Abundance =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span>                         <span class="co"># Use number of point occurrences as "pseudo-abundance"</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, PointName, FullName, Abundance) <span class="sc">%&gt;%</span>  <span class="co"># Select the columns we want</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span>                                      <span class="co"># Remove duplicates (there were 3 reps for each species by point)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FullName, Site) <span class="sc">%&gt;%</span>                      <span class="co"># For each species within each site...</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Abundance =</span> <span class="fu">sum</span>(Abundance)) <span class="sc">%&gt;%</span>         <span class="co"># ...sum the abundances</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> FullName, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Abundance,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span>                  <span class="co"># Turn the 3 columns into a species by site community data matrix</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()                                         <span class="co"># Drop and NA entries</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the functional diversity for each site - see ?pd for details. Note that while the function was written for phylogenetic diversity, we've used it for functional diversity.</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>sampFD <span class="ot">&lt;-</span> <span class="fu">pd</span>(samp[,<span class="sc">-</span><span class="dv">1</span>], ptree)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Make pretty and print table for sites</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sampFD) <span class="ot">&lt;-</span> samp<span class="sc">$</span>Site</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sampFD)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"FD"</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(sampFD, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">FD</th>
<th style="text-align: right;">SR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">invasion</td>
<td style="text-align: right;">10.696</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone</td>
<td style="text-align: right;">13.244</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld</td>
<td style="text-align: right;">5.237</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass</td>
<td style="text-align: right;">9.960</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand</td>
<td style="text-align: right;">9.191</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Remember the “species richness” (SR) here is the number of dominant species sampled for traits, not all species observed as above.</p>
</section>
<section id="fd-by-point-location" class="level3">
<h3 class="anchored" data-anchor-id="fd-by-point-location">FD by point location:</h3>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a community data matrix for the points within sites</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pointsamp <span class="ot">&lt;-</span> tdat <span class="sc">%&gt;%</span>                               <span class="co"># For points within sites </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PointName =</span> <span class="fu">paste</span>(Site, Point, <span class="at">sep =</span> <span class="st">"_"</span>), <span class="co"># Make a new name column combining Site and Point</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Abundance =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span>                         <span class="co"># Use number of occurrences as pseudo-abundance</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PointName, FullName, Abundance) <span class="sc">%&gt;%</span>        <span class="co"># Select the 3 columns we want</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span>                                      <span class="co"># Remove duplicates (there were 3 reps for each species by point)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> FullName, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Abundance,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>)  <span class="sc">%&gt;%</span>                 <span class="co"># Turn the 3 columns into a species by point community data matrix</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()                                         <span class="co"># Drop and NA entries</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate FD for points</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>pointsampFD <span class="ot">&lt;-</span> <span class="fu">pd</span>(pointsamp[,<span class="sc">-</span><span class="dv">1</span>], ptree)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make pretty and print table for point locations</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(pointsampFD) <span class="ot">&lt;-</span> pointsamp<span class="sc">$</span>PointName</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pointsampFD)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"FD"</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(pointsampFD, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">FD</th>
<th style="text-align: right;">SR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass_NW</td>
<td style="text-align: right;">6.049</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_NW</td>
<td style="text-align: right;">4.406</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_NW</td>
<td style="text-align: right;">7.266</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_NW</td>
<td style="text-align: right;">7.175</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_NW</td>
<td style="text-align: right;">7.974</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_SW</td>
<td style="text-align: right;">5.611</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_SW</td>
<td style="text-align: right;">4.524</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_SW</td>
<td style="text-align: right;">8.285</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_SW</td>
<td style="text-align: right;">7.167</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_SW</td>
<td style="text-align: right;">7.803</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grass_NE</td>
<td style="text-align: right;">3.928</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_NE</td>
<td style="text-align: right;">4.481</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_NE</td>
<td style="text-align: right;">6.349</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_NE</td>
<td style="text-align: right;">7.069</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_NE</td>
<td style="text-align: right;">10.854</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_SE</td>
<td style="text-align: right;">5.230</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_SE</td>
<td style="text-align: right;">4.153</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_SE</td>
<td style="text-align: right;">8.744</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_SE</td>
<td style="text-align: right;">8.106</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_SE</td>
<td style="text-align: right;">9.696</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="functional-beta-diversity" class="level2">
<h2 class="anchored" data-anchor-id="functional-beta-diversity">Functional Beta Diversity</h2>
<p>I’ve estimated functional similarity between sites using the method of Bryant et al.&nbsp;2008. See help file <code>?picante::phylosor</code> in R for details to help know how to interpret. Note that while the function was written for phylogenetic similarity, we’ve used it for functional similarity.</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate functional turnover between sites</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sampBFD <span class="ot">&lt;-</span> <span class="fu">phylosor</span>(samp[,<span class="sc">-</span><span class="dv">1</span>], ptree)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># some tomfoolery to present it nicely... (kable() doesn't like class "dist" - i.e. distance objects)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>msampBFD <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(sampBFD))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(msampBFD) <span class="ot">&lt;-</span> <span class="fu">list</span>(samp<span class="sc">$</span>Site, samp<span class="sc">$</span>Site)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>msampBFDl <span class="ot">&lt;-</span> msampBFD <span class="co"># make a new object and keep msampBFD, because you can use it with function metaMDS() </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>msampBFDl[<span class="fu">upper.tri</span>(msampBFDl, <span class="at">diag =</span> T)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>) <span class="co"># set table printing function to make NA values blank</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(msampBFDl, <span class="at">digits =</span> <span class="dv">3</span>) <span class="co"># print a table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">invasion</th>
<th style="text-align: right;">sandstone</th>
<th style="text-align: right;">renosterveld</th>
<th style="text-align: right;">grass</th>
<th style="text-align: right;">sand</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">invasion</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone</td>
<td style="text-align: right;">0.309</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld</td>
<td style="text-align: right;">0.423</td>
<td style="text-align: right;">0.400</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">grass</td>
<td style="text-align: right;">0.547</td>
<td style="text-align: right;">0.423</td>
<td style="text-align: right;">0.512</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand</td>
<td style="text-align: right;">0.410</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">0.467</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>And between point locations?</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate functional turnover between sites</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>pointsampBFD <span class="ot">&lt;-</span> <span class="fu">phylosor</span>(pointsamp[,<span class="sc">-</span><span class="dv">1</span>], ptree)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># some tomfoolery to present it nicely... (kable() doesn't like class "dist" - i.e. distance objects)</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>pmsampBFD <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(pointsampBFD))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(pmsampBFD) <span class="ot">&lt;-</span> <span class="fu">list</span>(pointsamp<span class="sc">$</span>PointName, pointsamp<span class="sc">$</span>PointName)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>pmsampBFDl <span class="ot">&lt;-</span> pmsampBFD <span class="co"># make a new object and keep msampBFD, because you can use it with function metaMDS() </span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>pmsampBFDl[<span class="fu">upper.tri</span>(pmsampBFDl, <span class="at">diag =</span> T)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>) <span class="co"># set table printing function to make NA values blank</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(pmsampBFDl, <span class="at">digits =</span> <span class="dv">3</span>) <span class="co"># print a table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">grass_NW</th>
<th style="text-align: right;">renosterveld_NW</th>
<th style="text-align: right;">invasion_NW</th>
<th style="text-align: right;">sand_NW</th>
<th style="text-align: right;">sandstone_NW</th>
<th style="text-align: right;">grass_SW</th>
<th style="text-align: right;">renosterveld_SW</th>
<th style="text-align: right;">invasion_SW</th>
<th style="text-align: right;">sand_SW</th>
<th style="text-align: right;">sandstone_SW</th>
<th style="text-align: right;">grass_NE</th>
<th style="text-align: right;">renosterveld_NE</th>
<th style="text-align: right;">invasion_NE</th>
<th style="text-align: right;">sand_NE</th>
<th style="text-align: right;">sandstone_NE</th>
<th style="text-align: right;">grass_SE</th>
<th style="text-align: right;">renosterveld_SE</th>
<th style="text-align: right;">invasion_SE</th>
<th style="text-align: right;">sand_SE</th>
<th style="text-align: right;">sandstone_SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass_NW</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_NW</td>
<td style="text-align: right;">0.705</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_NW</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.433</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_NW</td>
<td style="text-align: right;">0.510</td>
<td style="text-align: right;">0.600</td>
<td style="text-align: right;">0.350</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_NW</td>
<td style="text-align: right;">0.505</td>
<td style="text-align: right;">0.597</td>
<td style="text-align: right;">0.332</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_SW</td>
<td style="text-align: right;">0.578</td>
<td style="text-align: right;">0.673</td>
<td style="text-align: right;">0.393</td>
<td style="text-align: right;">0.630</td>
<td style="text-align: right;">0.534</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_SW</td>
<td style="text-align: right;">0.727</td>
<td style="text-align: right;">0.978</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">0.665</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_SW</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">0.854</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.447</td>
<td style="text-align: right;">0.570</td>
<td style="text-align: right;">0.526</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_SW</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.350</td>
<td style="text-align: right;">0.874</td>
<td style="text-align: right;">0.411</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.532</td>
<td style="text-align: right;">0.445</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_SW</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.578</td>
<td style="text-align: right;">0.444</td>
<td style="text-align: right;">0.536</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">grass_NE</td>
<td style="text-align: right;">0.771</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">0.607</td>
<td style="text-align: right;">0.595</td>
<td style="text-align: right;">0.707</td>
<td style="text-align: right;">0.886</td>
<td style="text-align: right;">0.552</td>
<td style="text-align: right;">0.561</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_NE</td>
<td style="text-align: right;">0.706</td>
<td style="text-align: right;">0.861</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">0.610</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.668</td>
<td style="text-align: right;">0.874</td>
<td style="text-align: right;">0.528</td>
<td style="text-align: right;">0.534</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.868</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_NE</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">0.627</td>
<td style="text-align: right;">0.535</td>
<td style="text-align: right;">0.554</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.665</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.513</td>
<td style="text-align: right;">0.509</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">0.622</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_NE</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">0.621</td>
<td style="text-align: right;">0.353</td>
<td style="text-align: right;">0.955</td>
<td style="text-align: right;">0.502</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;">0.615</td>
<td style="text-align: right;">0.457</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">0.632</td>
<td style="text-align: right;">0.633</td>
<td style="text-align: right;">0.617</td>
<td style="text-align: right;">0.559</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_NE</td>
<td style="text-align: right;">0.399</td>
<td style="text-align: right;">0.442</td>
<td style="text-align: right;">0.279</td>
<td style="text-align: right;">0.632</td>
<td style="text-align: right;">0.774</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">0.373</td>
<td style="text-align: right;">0.586</td>
<td style="text-align: right;">0.633</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">0.422</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_SE</td>
<td style="text-align: right;">0.646</td>
<td style="text-align: right;">0.723</td>
<td style="text-align: right;">0.404</td>
<td style="text-align: right;">0.543</td>
<td style="text-align: right;">0.528</td>
<td style="text-align: right;">0.622</td>
<td style="text-align: right;">0.726</td>
<td style="text-align: right;">0.499</td>
<td style="text-align: right;">0.502</td>
<td style="text-align: right;">0.704</td>
<td style="text-align: right;">0.795</td>
<td style="text-align: right;">0.735</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_SE</td>
<td style="text-align: right;">0.726</td>
<td style="text-align: right;">0.904</td>
<td style="text-align: right;">0.443</td>
<td style="text-align: right;">0.595</td>
<td style="text-align: right;">0.610</td>
<td style="text-align: right;">0.690</td>
<td style="text-align: right;">0.923</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.550</td>
<td style="text-align: right;">0.596</td>
<td style="text-align: right;">0.891</td>
<td style="text-align: right;">0.883</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">0.635</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">0.755</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_SE</td>
<td style="text-align: right;">0.608</td>
<td style="text-align: right;">0.473</td>
<td style="text-align: right;">0.830</td>
<td style="text-align: right;">0.421</td>
<td style="text-align: right;">0.372</td>
<td style="text-align: right;">0.522</td>
<td style="text-align: right;">0.469</td>
<td style="text-align: right;">0.837</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">0.376</td>
<td style="text-align: right;">0.491</td>
<td style="text-align: right;">0.470</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.424</td>
<td style="text-align: right;">0.317</td>
<td style="text-align: right;">0.445</td>
<td style="text-align: right;">0.482</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_SE</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.329</td>
<td style="text-align: right;">0.890</td>
<td style="text-align: right;">0.436</td>
<td style="text-align: right;">0.635</td>
<td style="text-align: right;">0.534</td>
<td style="text-align: right;">0.468</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">0.557</td>
<td style="text-align: right;">0.560</td>
<td style="text-align: right;">0.536</td>
<td style="text-align: right;">0.534</td>
<td style="text-align: right;">0.896</td>
<td style="text-align: right;">0.601</td>
<td style="text-align: right;">0.506</td>
<td style="text-align: right;">0.550</td>
<td style="text-align: right;">0.437</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_SE</td>
<td style="text-align: right;">0.428</td>
<td style="text-align: right;">0.478</td>
<td style="text-align: right;">0.298</td>
<td style="text-align: right;">0.689</td>
<td style="text-align: right;">0.824</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: right;">0.397</td>
<td style="text-align: right;">0.626</td>
<td style="text-align: right;">0.534</td>
<td style="text-align: right;">0.495</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">0.693</td>
<td style="text-align: right;">0.929</td>
<td style="text-align: right;">0.452</td>
<td style="text-align: right;">0.487</td>
<td style="text-align: right;">0.337</td>
<td style="text-align: right;">0.653</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
</section>
<section id="environment" class="level2">
<h2 class="anchored" data-anchor-id="environment">Environment</h2>
<p>First, let’s calculate % canopy cover from the densiometer readings and then look at site-level averages for most variables.</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pdat <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/pracdatasheet2023.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Sites2023"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Site"            "Point"           "SitePoint"       "Densiometer"    
 [5] "SoilPH"          "SoilColour"      "PercentBareSoil" "Dung_Eland"     
 [9] "Dung_Bontebok"   "Dung_Ostrich"    "Dung_Other"      "Comments"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert densiometer readings to canopy cover</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>pdat<span class="sc">$</span>CanopyCover <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="fl">4.16</span><span class="sc">*</span>pdat<span class="sc">$</span>Densiometer</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate all the dung counts into one</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>pdat<span class="sc">$</span>Dung <span class="ot">&lt;-</span> pdat <span class="sc">%&gt;%</span> <span class="fu">select</span>(Dung_Eland, Dung_Bontebok, Dung_Ostrich, Dung_Other) <span class="sc">%&gt;%</span> <span class="fu">rowSums</span>()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize environmental data to site level (i.e. take the average of point measurements)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> pdat <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">BareSoil =</span> <span class="fu">mean</span>(PercentBareSoil), </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Soil pH</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(SoilPH), </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">Dung =</span> <span class="fu">mean</span>(Dung),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">% Canopy Cover</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(CanopyCover))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print table</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(env, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Site</th>
<th style="text-align: right;">BareSoil</th>
<th style="text-align: right;">Soil pH</th>
<th style="text-align: right;">Dung</th>
<th style="text-align: right;">% Canopy Cover</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">4.85</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">43.84</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">3.88</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">94.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld</td>
<td style="text-align: right;">15.50</td>
<td style="text-align: right;">5.47</td>
<td style="text-align: right;">6.25</td>
<td style="text-align: right;">39.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">4.81</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">72.96</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone</td>
<td style="text-align: right;">13.25</td>
<td style="text-align: right;">4.76</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">86.48</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Or point level</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize environmental data to site level (i.e. take the average of point measurements)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>penv <span class="ot">&lt;-</span> pdat <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SitePoint) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">BareSoil =</span> <span class="fu">mean</span>(PercentBareSoil), </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Soil pH</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(SoilPH), </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Dung =</span> <span class="fu">mean</span>(Dung),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">% Canopy Cover</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(CanopyCover))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print table</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(penv, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">SitePoint</th>
<th style="text-align: right;">BareSoil</th>
<th style="text-align: right;">Soil pH</th>
<th style="text-align: right;">Dung</th>
<th style="text-align: right;">% Canopy Cover</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass_NE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5.13</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">45.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_NW</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4.57</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">41.76</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grass_SE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4.60</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">37.60</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_SW</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5.11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">50.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_NE</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3.70</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">100.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_NW</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4.10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">91.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_SE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">100.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_SW</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3.93</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">87.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_NE</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">5.70</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">16.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_NW</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5.35</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">20.96</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_SE</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5.40</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">41.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_SW</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">5.43</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">79.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_NE</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4.54</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">83.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_NW</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.95</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">54.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_SE</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.82</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">79.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_SW</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.94</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">75.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_NE</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">4.72</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">100.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_NW</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.70</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">58.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_SE</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4.91</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">91.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_SW</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">4.70</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">95.84</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Or we can look at environmental dissimilarity among sites</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the environmental data to create a distance matrix among sites</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">scale</span>(env[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])) <span class="co"># check ?scale - what does this function do and why do you think I used it?</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># some tomfoolery to present it nicely... (kable() doesn't like class "dist" - i.e. distance objects)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>edis <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(D))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(edis) <span class="ot">&lt;-</span> <span class="fu">list</span>(env<span class="sc">$</span>Site, env<span class="sc">$</span>Site)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>edisl <span class="ot">&lt;-</span> edis <span class="co"># make a new object and keep edis, because we'll use it later</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>edisl[<span class="fu">upper.tri</span>(edisl, <span class="at">diag =</span> T)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>) <span class="co"># set table printing function to make NA values blank</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(edisl, <span class="at">digits =</span> <span class="dv">3</span>) <span class="co"># print a table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">grass</th>
<th style="text-align: right;">invasion</th>
<th style="text-align: right;">renosterveld</th>
<th style="text-align: right;">sand</th>
<th style="text-align: right;">sandstone</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion</td>
<td style="text-align: right;">2.719</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld</td>
<td style="text-align: right;">2.841</td>
<td style="text-align: right;">4.717</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sand</td>
<td style="text-align: right;">1.302</td>
<td style="text-align: right;">1.878</td>
<td style="text-align: right;">3.488</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone</td>
<td style="text-align: right;">2.412</td>
<td style="text-align: right;">2.380</td>
<td style="text-align: right;">3.271</td>
<td style="text-align: right;">1.649</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Or among points</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the environmental data to create a distance matrix among sites</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>pD <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">scale</span>(penv[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])) <span class="co"># check ?scale - what does this function do and why do you think I used it?</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># some tomfoolery to present it nicely... (kable() doesn't like class "dist" - i.e. distance objects)</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>pedis <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(pD))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(pedis) <span class="ot">&lt;-</span> <span class="fu">list</span>(penv<span class="sc">$</span>SitePoint, penv<span class="sc">$</span>SitePoint)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>pedisl <span class="ot">&lt;-</span> pedis <span class="co"># make a new object and keep pedis, because we'll use it later</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>pedisl[<span class="fu">upper.tri</span>(pedisl, <span class="at">diag =</span> T)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>) <span class="co"># set table printing function to make NA values blank</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(pedisl, <span class="at">digits =</span> <span class="dv">3</span>) <span class="co"># print a table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">grass_NE</th>
<th style="text-align: right;">grass_NW</th>
<th style="text-align: right;">grass_SE</th>
<th style="text-align: right;">grass_SW</th>
<th style="text-align: right;">invasion_NE</th>
<th style="text-align: right;">invasion_NW</th>
<th style="text-align: right;">invasion_SE</th>
<th style="text-align: right;">invasion_SW</th>
<th style="text-align: right;">renosterveld_NE</th>
<th style="text-align: right;">renosterveld_NW</th>
<th style="text-align: right;">renosterveld_SE</th>
<th style="text-align: right;">renosterveld_SW</th>
<th style="text-align: right;">sand_NE</th>
<th style="text-align: right;">sand_NW</th>
<th style="text-align: right;">sand_SE</th>
<th style="text-align: right;">sand_SW</th>
<th style="text-align: right;">sandstone_NE</th>
<th style="text-align: right;">sandstone_NW</th>
<th style="text-align: right;">sandstone_SE</th>
<th style="text-align: right;">sandstone_SW</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass_NE</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_NW</td>
<td style="text-align: right;">2.034</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">grass_SE</td>
<td style="text-align: right;">2.108</td>
<td style="text-align: right;">1.025</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_SW</td>
<td style="text-align: right;">1.857</td>
<td style="text-align: right;">1.442</td>
<td style="text-align: right;">1.034</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_NE</td>
<td style="text-align: right;">3.787</td>
<td style="text-align: right;">2.725</td>
<td style="text-align: right;">2.853</td>
<td style="text-align: right;">3.185</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_NW</td>
<td style="text-align: right;">2.918</td>
<td style="text-align: right;">2.230</td>
<td style="text-align: right;">2.214</td>
<td style="text-align: right;">2.416</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_SE</td>
<td style="text-align: right;">3.646</td>
<td style="text-align: right;">2.757</td>
<td style="text-align: right;">2.722</td>
<td style="text-align: right;">3.019</td>
<td style="text-align: right;">0.498</td>
<td style="text-align: right;">0.740</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_SW</td>
<td style="text-align: right;">3.242</td>
<td style="text-align: right;">2.280</td>
<td style="text-align: right;">2.200</td>
<td style="text-align: right;">2.547</td>
<td style="text-align: right;">0.779</td>
<td style="text-align: right;">0.506</td>
<td style="text-align: right;">0.524</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_NE</td>
<td style="text-align: right;">4.199</td>
<td style="text-align: right;">4.443</td>
<td style="text-align: right;">5.247</td>
<td style="text-align: right;">5.059</td>
<td style="text-align: right;">6.493</td>
<td style="text-align: right;">6.075</td>
<td style="text-align: right;">6.657</td>
<td style="text-align: right;">6.327</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_NW</td>
<td style="text-align: right;">1.039</td>
<td style="text-align: right;">2.284</td>
<td style="text-align: right;">2.394</td>
<td style="text-align: right;">2.199</td>
<td style="text-align: right;">4.568</td>
<td style="text-align: right;">3.764</td>
<td style="text-align: right;">4.467</td>
<td style="text-align: right;">4.016</td>
<td style="text-align: right;">3.715</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_SE</td>
<td style="text-align: right;">0.547</td>
<td style="text-align: right;">2.244</td>
<td style="text-align: right;">2.365</td>
<td style="text-align: right;">1.957</td>
<td style="text-align: right;">4.197</td>
<td style="text-align: right;">3.341</td>
<td style="text-align: right;">4.073</td>
<td style="text-align: right;">3.663</td>
<td style="text-align: right;">3.895</td>
<td style="text-align: right;">0.774</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_SW</td>
<td style="text-align: right;">2.213</td>
<td style="text-align: right;">3.113</td>
<td style="text-align: right;">3.725</td>
<td style="text-align: right;">3.279</td>
<td style="text-align: right;">4.296</td>
<td style="text-align: right;">3.680</td>
<td style="text-align: right;">4.329</td>
<td style="text-align: right;">4.098</td>
<td style="text-align: right;">3.211</td>
<td style="text-align: right;">2.622</td>
<td style="text-align: right;">2.106</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_NE</td>
<td style="text-align: right;">2.569</td>
<td style="text-align: right;">1.670</td>
<td style="text-align: right;">1.725</td>
<td style="text-align: right;">1.645</td>
<td style="text-align: right;">1.647</td>
<td style="text-align: right;">1.006</td>
<td style="text-align: right;">1.540</td>
<td style="text-align: right;">1.181</td>
<td style="text-align: right;">5.537</td>
<td style="text-align: right;">3.293</td>
<td style="text-align: right;">2.869</td>
<td style="text-align: right;">3.293</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_NW</td>
<td style="text-align: right;">1.906</td>
<td style="text-align: right;">1.242</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.342</td>
<td style="text-align: right;">2.850</td>
<td style="text-align: right;">2.102</td>
<td style="text-align: right;">2.697</td>
<td style="text-align: right;">2.222</td>
<td style="text-align: right;">5.098</td>
<td style="text-align: right;">2.340</td>
<td style="text-align: right;">2.076</td>
<td style="text-align: right;">3.252</td>
<td style="text-align: right;">1.333</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_SE</td>
<td style="text-align: right;">2.305</td>
<td style="text-align: right;">1.633</td>
<td style="text-align: right;">1.603</td>
<td style="text-align: right;">1.225</td>
<td style="text-align: right;">2.182</td>
<td style="text-align: right;">1.463</td>
<td style="text-align: right;">2.041</td>
<td style="text-align: right;">1.670</td>
<td style="text-align: right;">5.357</td>
<td style="text-align: right;">2.986</td>
<td style="text-align: right;">2.536</td>
<td style="text-align: right;">3.110</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.965</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_SW</td>
<td style="text-align: right;">2.182</td>
<td style="text-align: right;">1.586</td>
<td style="text-align: right;">1.533</td>
<td style="text-align: right;">1.007</td>
<td style="text-align: right;">2.440</td>
<td style="text-align: right;">1.709</td>
<td style="text-align: right;">2.300</td>
<td style="text-align: right;">1.913</td>
<td style="text-align: right;">5.232</td>
<td style="text-align: right;">2.814</td>
<td style="text-align: right;">2.371</td>
<td style="text-align: right;">3.043</td>
<td style="text-align: right;">0.794</td>
<td style="text-align: right;">0.786</td>
<td style="text-align: right;">0.266</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_NE</td>
<td style="text-align: right;">3.668</td>
<td style="text-align: right;">2.603</td>
<td style="text-align: right;">3.291</td>
<td style="text-align: right;">3.066</td>
<td style="text-align: right;">2.643</td>
<td style="text-align: right;">2.654</td>
<td style="text-align: right;">2.898</td>
<td style="text-align: right;">2.795</td>
<td style="text-align: right;">4.822</td>
<td style="text-align: right;">4.176</td>
<td style="text-align: right;">3.769</td>
<td style="text-align: right;">3.086</td>
<td style="text-align: right;">2.095</td>
<td style="text-align: right;">2.846</td>
<td style="text-align: right;">2.215</td>
<td style="text-align: right;">2.300</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_NW</td>
<td style="text-align: right;">2.062</td>
<td style="text-align: right;">1.133</td>
<td style="text-align: right;">0.790</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">2.403</td>
<td style="text-align: right;">1.681</td>
<td style="text-align: right;">2.253</td>
<td style="text-align: right;">1.763</td>
<td style="text-align: right;">5.280</td>
<td style="text-align: right;">2.596</td>
<td style="text-align: right;">2.329</td>
<td style="text-align: right;">3.365</td>
<td style="text-align: right;">1.002</td>
<td style="text-align: right;">0.479</td>
<td style="text-align: right;">0.816</td>
<td style="text-align: right;">0.774</td>
<td style="text-align: right;">2.727</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_SE</td>
<td style="text-align: right;">2.615</td>
<td style="text-align: right;">1.989</td>
<td style="text-align: right;">2.166</td>
<td style="text-align: right;">1.702</td>
<td style="text-align: right;">2.228</td>
<td style="text-align: right;">1.655</td>
<td style="text-align: right;">2.161</td>
<td style="text-align: right;">1.905</td>
<td style="text-align: right;">5.294</td>
<td style="text-align: right;">3.307</td>
<td style="text-align: right;">2.792</td>
<td style="text-align: right;">2.949</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">1.487</td>
<td style="text-align: right;">0.615</td>
<td style="text-align: right;">0.720</td>
<td style="text-align: right;">1.756</td>
<td style="text-align: right;">1.399</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_SW</td>
<td style="text-align: right;">3.307</td>
<td style="text-align: right;">2.240</td>
<td style="text-align: right;">2.854</td>
<td style="text-align: right;">2.631</td>
<td style="text-align: right;">2.307</td>
<td style="text-align: right;">2.213</td>
<td style="text-align: right;">2.511</td>
<td style="text-align: right;">2.366</td>
<td style="text-align: right;">4.901</td>
<td style="text-align: right;">3.864</td>
<td style="text-align: right;">3.443</td>
<td style="text-align: right;">2.987</td>
<td style="text-align: right;">1.601</td>
<td style="text-align: right;">2.395</td>
<td style="text-align: right;">1.727</td>
<td style="text-align: right;">1.826</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">2.256</td>
<td style="text-align: right;">1.291</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="ecosystem-function-1" class="level2">
<h2 class="anchored" data-anchor-id="ecosystem-function-1">Ecosystem function</h2>
<p>To explore ecosystem function we looked at the 20-year time-series of the Normalized Difference Vegetation Index (NDVI) recorded by the MODIS satellite mission. From these we used the post-fire recovery trajectory modelling framework developed by Wilson et al (2015) to derive estimates of the mean maximum NDVI (alpha + gamma), and the amplitude and timing of seasonality (big alpha and phi) as our measures of ecosystem function. Here I’ve provided a table of these parameters by site and plots of the model fits.</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># source("prac/01_downloadNDVI.R") # this is only run once to download the MODIS data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"code/02_plot.NDVI.R"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"code/03_negexp_model.R"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="do">###Get data</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>adat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/modis.csv"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#adat &lt;- adat %&gt;% filter(calendar_date &gt; as.Date("2015-9-14"))</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="do">###Plot all timeseries</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>adat <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> calendar_date, <span class="at">y =</span> value<span class="sc">*</span>scale)) <span class="sc">+</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_point() +</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span> site) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"NDVI"</span>) <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.2</span>, <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now let’s fit the model and plot the model fit (blue) over the observed data (black circles).</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Loop through sites fitting the model</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get site names</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>sitnms <span class="ot">&lt;-</span> <span class="fu">unique</span>(adat<span class="sc">$</span>site)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set initial parameters</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>par <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">gamma =</span> <span class="fl">0.4</span>, <span class="at">lambda =</span> <span class="fl">0.5</span>, <span class="at">A =</span> <span class="fl">0.1</span>, <span class="at">phi =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Make output table</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">initial =</span> par)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sitnms)) {</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> adat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> sitnms[i])</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate age from date</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>age <span class="ot">&lt;-</span> (<span class="fu">as.numeric</span>(dat<span class="sc">$</span>calendar_date) <span class="sc">-</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(dat<span class="sc">$</span>calendar_date), <span class="at">na.rm =</span> T))<span class="sc">/</span><span class="fl">365.25</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># scale NDVI</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>NDVI <span class="ot">&lt;-</span> dat<span class="sc">$</span>value<span class="sc">*</span>dat<span class="sc">$</span>scale</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>fit_negexpMLES <span class="ot">&lt;-</span> <span class="fu">fit.negexpS.MLE</span>(dat, par)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.NDVI</span>(dat, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>), <span class="at">main =</span> sitnms[i])</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="co"># add curve with MLE parameters</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(dat<span class="sc">$</span>age, <span class="fu">pred.negexpS</span>(fit_negexpMLES<span class="sc">$</span>par,dat<span class="sc">$</span>age), <span class="at">col =</span> <span class="st">'skyblue'</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="co"># bind to output</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">cbind</span>(out, fit_negexpMLES<span class="sc">$</span>par)</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove unnecessary objects to keep the workspace tidy</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i, par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And view a table of the parameter estimates</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy and present table</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(out) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"initial"</span>, sitnms)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(out)[<span class="sc">-</span><span class="dv">1</span>,])</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate maximum greeness (alpha + gamma)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>alpha_gamma <span class="ot">=</span> out<span class="sc">$</span>alpha <span class="sc">+</span> out<span class="sc">$</span>gamma</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(out, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">alpha</th>
<th style="text-align: right;">gamma</th>
<th style="text-align: right;">lambda</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">phi</th>
<th style="text-align: right;">alpha_gamma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">limestone</td>
<td style="text-align: right;">0.427</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">10.057</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">-1.441</td>
<td style="text-align: right;">0.583</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand</td>
<td style="text-align: right;">0.343</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">4.150</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">-1.326</td>
<td style="text-align: right;">0.568</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion</td>
<td style="text-align: right;">0.695</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.459</td>
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">-1.296</td>
<td style="text-align: right;">0.727</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone</td>
<td style="text-align: right;">0.603</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">10.539</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">-1.470</td>
<td style="text-align: right;">0.666</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grass</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">-0.016</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">-1.762</td>
<td style="text-align: right;">0.563</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">2.670</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">-2.101</td>
<td style="text-align: right;">0.487</td>
</tr>
</tbody>
</table>
</div>
</div>
<blockquote class="blockquote">
<p><em>Discussion hint: Are there any obvious properties of the time-series that are not captured by these parameters? How do they differ between sites and what may the causes be?</em></p>
</blockquote>
<p>One issue here is sample size, because we only have a few sites… One could perhaps get around the sample size issue by using a satellite with finer ground sample distance that we could relate to each point location, such as Sentinel 2 (10m GSD vs MODIS 250m). I’ve extracted and plotted these data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sent <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/sentinel.csv"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">###Plot all timeseries</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>sent <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> calendar_date, <span class="at">y =</span> value<span class="sc">*</span>scale)) <span class="sc">+</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Site <span class="sc">~</span> Point) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"NDVI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Unfortunately, as you can see the record is much shorter and there’s a lot of variability and big jumps in the NDVI value of the finer resolution instrument. We can still try to fit the model and see what we get though.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Loop through site_points fitting the model</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get joint site_point names</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>pntnms <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">paste0</span>(sent<span class="sc">$</span>Site, <span class="st">"_"</span>, sent<span class="sc">$</span>Point)))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>sent<span class="sc">$</span>site_point <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sent<span class="sc">$</span>Site, <span class="st">"_"</span>, sent<span class="sc">$</span>Point)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set initial parameters</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>par <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">gamma =</span> <span class="fl">0.4</span>, <span class="at">lambda =</span> <span class="fl">0.5</span>, <span class="at">A =</span> <span class="fl">0.1</span>, <span class="at">phi =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make output table</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>sout <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">initial =</span> par)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pntnms)) {</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> sent <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site_point <span class="sc">==</span> pntnms[i])</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate age from date</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>age <span class="ot">&lt;-</span> (<span class="fu">as.numeric</span>(dat<span class="sc">$</span>calendar_date) <span class="sc">-</span> <span class="fu">as.numeric</span>(<span class="fu">as.Date</span>(<span class="st">"19920101"</span>, <span class="st">"%Y%m%d"</span>)))<span class="sc">/</span><span class="fl">365.25</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># scale NDVI</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>NDVI <span class="ot">&lt;-</span> dat<span class="sc">$</span>value<span class="sc">*</span>dat<span class="sc">$</span>scale</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>fit_negexpMLES <span class="ot">&lt;-</span> <span class="fu">fit.negexpS.MLE</span>(dat, par)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plot.NDVI(dat, ylim = c(0, 1), main = sitnms[i])</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="co"># # add curve with MLE parameters</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="co"># lines(dat$age, pred.negexpS(fit_negexpMLES$par,dat$age), col = 'skyblue', lwd = 3)</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="co"># bind to output</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>sout <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sout, fit_negexpMLES<span class="sc">$</span>par)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove unnecessary objects to keep the workspace tidy</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i, par)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy and present table</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sout) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"initial"</span>, pntnms)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>sout <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(sout)[<span class="sc">-</span><span class="dv">1</span>,])</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>sout<span class="sc">$</span>alpha_gamma <span class="ot">=</span> sout<span class="sc">$</span>alpha <span class="sc">+</span> sout<span class="sc">$</span>gamma</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(sout, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">alpha</th>
<th style="text-align: right;">gamma</th>
<th style="text-align: right;">lambda</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">phi</th>
<th style="text-align: right;">alpha_gamma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass_NE</td>
<td style="text-align: right;">-0.935</td>
<td style="text-align: right;">1.440</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">-0.114</td>
<td style="text-align: right;">0.380</td>
<td style="text-align: right;">0.505</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_NW</td>
<td style="text-align: right;">2.464</td>
<td style="text-align: right;">-1.769</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">-2.450</td>
<td style="text-align: right;">0.695</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grass_SE</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">0.418</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">-0.127</td>
<td style="text-align: right;">0.227</td>
<td style="text-align: right;">0.567</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass_SW</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">-0.046</td>
<td style="text-align: right;">0.320</td>
<td style="text-align: right;">0.674</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_NE</td>
<td style="text-align: right;">0.369</td>
<td style="text-align: right;">0.361</td>
<td style="text-align: right;">1.191</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">-2.395</td>
<td style="text-align: right;">0.730</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_NW</td>
<td style="text-align: right;">-0.025</td>
<td style="text-align: right;">0.772</td>
<td style="text-align: right;">1.516</td>
<td style="text-align: right;">0.092</td>
<td style="text-align: right;">-2.316</td>
<td style="text-align: right;">0.747</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion_SE</td>
<td style="text-align: right;">1.505</td>
<td style="text-align: right;">-0.701</td>
<td style="text-align: right;">2.041</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">-2.588</td>
<td style="text-align: right;">0.803</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion_SW</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">0.334</td>
<td style="text-align: right;">0.927</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">-2.193</td>
<td style="text-align: right;">0.765</td>
</tr>
<tr class="odd">
<td style="text-align: left;">limestone_NE</td>
<td style="text-align: right;">-2.122</td>
<td style="text-align: right;">2.643</td>
<td style="text-align: right;">1.825</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: right;">-2.455</td>
<td style="text-align: right;">0.521</td>
</tr>
<tr class="even">
<td style="text-align: left;">limestone_NW</td>
<td style="text-align: right;">0.401</td>
<td style="text-align: right;">0.143</td>
<td style="text-align: right;">4.159</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">-2.316</td>
<td style="text-align: right;">0.544</td>
</tr>
<tr class="odd">
<td style="text-align: left;">limestone_SE</td>
<td style="text-align: right;">0.425</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">1.064</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">-2.401</td>
<td style="text-align: right;">0.504</td>
</tr>
<tr class="even">
<td style="text-align: left;">limestone_SW</td>
<td style="text-align: right;">-0.333</td>
<td style="text-align: right;">0.824</td>
<td style="text-align: right;">0.936</td>
<td style="text-align: right;">0.103</td>
<td style="text-align: right;">-2.265</td>
<td style="text-align: right;">0.491</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_NE</td>
<td style="text-align: right;">-2.372</td>
<td style="text-align: right;">2.817</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">-0.105</td>
<td style="text-align: right;">-0.002</td>
<td style="text-align: right;">0.446</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_NW</td>
<td style="text-align: right;">2.066</td>
<td style="text-align: right;">-1.630</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">-0.095</td>
<td style="text-align: right;">0.219</td>
<td style="text-align: right;">0.436</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld_SE</td>
<td style="text-align: right;">0.163</td>
<td style="text-align: right;">0.259</td>
<td style="text-align: right;">0.325</td>
<td style="text-align: right;">-0.077</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">0.422</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld_SW</td>
<td style="text-align: right;">0.212</td>
<td style="text-align: right;">0.221</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">-0.107</td>
<td style="text-align: right;">-0.010</td>
<td style="text-align: right;">0.432</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_NE</td>
<td style="text-align: right;">-1.295</td>
<td style="text-align: right;">1.803</td>
<td style="text-align: right;">0.839</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">-2.372</td>
<td style="text-align: right;">0.509</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_NW</td>
<td style="text-align: right;">0.339</td>
<td style="text-align: right;">0.187</td>
<td style="text-align: right;">1.814</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">-2.465</td>
<td style="text-align: right;">0.527</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sand_SE</td>
<td style="text-align: right;">0.629</td>
<td style="text-align: right;">-0.193</td>
<td style="text-align: right;">1.104</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">-2.183</td>
<td style="text-align: right;">0.435</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_SW</td>
<td style="text-align: right;">0.268</td>
<td style="text-align: right;">0.268</td>
<td style="text-align: right;">1.553</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">-2.248</td>
<td style="text-align: right;">0.536</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_NE</td>
<td style="text-align: right;">-0.301</td>
<td style="text-align: right;">0.851</td>
<td style="text-align: right;">2.707</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">-2.283</td>
<td style="text-align: right;">0.550</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_NW</td>
<td style="text-align: right;">0.388</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">1.426</td>
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">-2.352</td>
<td style="text-align: right;">0.564</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sandstone_SE</td>
<td style="text-align: right;">0.394</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">0.917</td>
<td style="text-align: right;">0.160</td>
<td style="text-align: right;">-2.329</td>
<td style="text-align: right;">0.594</td>
</tr>
<tr class="even">
<td style="text-align: left;">sandstone_SW</td>
<td style="text-align: right;">0.257</td>
<td style="text-align: right;">0.315</td>
<td style="text-align: right;">1.274</td>
<td style="text-align: right;">0.162</td>
<td style="text-align: right;">-2.335</td>
<td style="text-align: right;">0.571</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="statistical-tests" class="level1">
<h1>Statistical tests</h1>
<section id="plotting" class="level2">
<h2 class="anchored" data-anchor-id="plotting">Plotting</h2>
<p>Here’s an example of how to make a boxplot of point location measures by site for one variable. You can make a panel of plots if you convert <code>pdat</code> into long format using <code>pivot_longer()</code> and adding <code>+ facet_wrap(~name, scales = "free")</code> to the end of the plotting call (where <code>name</code> is whatever you provided for the <code>names_to =</code> argument in <code>pivot_longer()</code>).</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make boxplot of any variable using point location data</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>pdat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> CanopyCover, <span class="at">x =</span> Site))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="test-for-significant-difference-among-sites" class="level2">
<h2 class="anchored" data-anchor-id="test-for-significant-difference-among-sites">Test for significant difference among sites</h2>
<p>Here we use the non-parametric Kruskal-Wallis rank sum test.</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run non-parametric Kruskal-Wallis rank sum test</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(CanopyCover <span class="sc">~</span> Site, <span class="at">data =</span> pdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  CanopyCover by Site
Kruskal-Wallis chi-squared = 14.246, df = 4, p-value = 0.006549</code></pre>
</div>
</div>
<p>And use Dunn’s posthoc test to explore where the differences lie.</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dunn's Post hoc test to directly explore differences among sites</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>posthoc <span class="ot">&lt;-</span> <span class="fu">dunnTest</span>(CanopyCover <span class="sc">~</span> Site, <span class="at">data =</span> pdat,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"bh"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Site was coerced to a factor.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(posthoc<span class="sc">$</span>res, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Comparison</th>
<th style="text-align: right;">Z</th>
<th style="text-align: right;">P.unadj</th>
<th style="text-align: right;">P.adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass - invasion</td>
<td style="text-align: right;">-2.816</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">0.024</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass - renosterveld</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">0.928</td>
<td style="text-align: right;">0.928</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion - renosterveld</td>
<td style="text-align: right;">2.906</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.037</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass - sand</td>
<td style="text-align: right;">-1.318</td>
<td style="text-align: right;">0.187</td>
<td style="text-align: right;">0.268</td>
</tr>
<tr class="odd">
<td style="text-align: left;">invasion - sand</td>
<td style="text-align: right;">1.498</td>
<td style="text-align: right;">0.134</td>
<td style="text-align: right;">0.268</td>
</tr>
<tr class="even">
<td style="text-align: left;">renosterveld - sand</td>
<td style="text-align: right;">-1.408</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.265</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grass - sandstone</td>
<td style="text-align: right;">-2.397</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.041</td>
</tr>
<tr class="even">
<td style="text-align: left;">invasion - sandstone</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">0.675</td>
<td style="text-align: right;">0.750</td>
</tr>
<tr class="odd">
<td style="text-align: left;">renosterveld - sandstone</td>
<td style="text-align: right;">-2.487</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">0.043</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand - sandstone</td>
<td style="text-align: right;">-1.079</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">0.351</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="correlations" class="level2">
<h2 class="anchored" data-anchor-id="correlations">Correlations</h2>
<p>e.g.&nbsp;Exploring relationships between measures of biodiversity and either environmental properties or measures of ecosystem function</p>
<p>This practical was a learning exercise and constrained by time and available resources. Perhaps the biggest drawback was the low number of (or lack of replication within) ecosystem types sampled. That said, plotting the relationships between the different site level variables gives us some indication of whether further sampling is likely to produce strong evidence of clear relationships. For this prac write up, I’ll forgive you for discussing significant (p &lt; 0.05) or near-significant (p &lt; 0.1) relationships based on a sample size of 6… Usually, this would not be okay…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join site level measures of ecosystem function and environment</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>Site <span class="ot">&lt;-</span> <span class="fu">rownames</span>(out)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">left_join</span>(env, out)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot biplots of all combinations of variables</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(dat[,<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform correlations of all combinations of variables</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.table</span>(dat[,<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$r
                 BareSoil     Soil pH       Dung % Canopy Cover       alpha
BareSoil        1.0000000  0.68026677  0.6164433     -0.2852437 -0.16312343
Soil pH         0.6802668  1.00000000  0.7248453     -0.8102876 -0.66407328
Dung            0.6164433  0.72484535  1.0000000     -0.7640847 -0.28701325
% Canopy Cover -0.2852437 -0.81028763 -0.7640847      1.0000000  0.43603458
alpha          -0.1631234 -0.66407328 -0.2870132      0.4360346  1.00000000
gamma          -0.1471386  0.05651833 -0.3269539      0.2788752 -0.73596903
lambda          0.5870608  0.18475865 -0.2579002      0.3790214 -0.09052831
A               0.6673584  0.97743485  0.8169335     -0.8879790 -0.53433020
phi            -0.6139559 -0.80889039 -0.9284522      0.8896190  0.21945721
alpha_gamma    -0.3835639 -0.92036592 -0.7414454      0.9133619  0.74937766
                     gamma      lambda           A        phi alpha_gamma
BareSoil       -0.14713859  0.58706080  0.66735842 -0.6139559  -0.3835639
Soil pH         0.05651833  0.18475865  0.97743485 -0.8088904  -0.9203659
Dung           -0.32695391 -0.25790015  0.81693352 -0.9284522  -0.7414454
% Canopy Cover  0.27887519  0.37902145 -0.88797898  0.8896190   0.9133619
alpha          -0.73596903 -0.09052831 -0.53433020  0.2194572   0.7493777
gamma           1.00000000  0.31418112 -0.13777024  0.4758352  -0.1032380
lambda          0.31418112  1.00000000  0.04598951  0.1987411   0.1742770
A              -0.13777024  0.04598951  1.00000000 -0.9126694  -0.9197706
phi             0.47583524  0.19874115 -0.91266938  1.0000000   0.7878043
alpha_gamma    -0.10323798  0.17427701 -0.91977061  0.7878043   1.0000000

$df
[1] 3

$P
                BareSoil     Soil pH       Dung % Canopy Cover     alpha
BareSoil       0.0000000 0.206301935 0.26813890     0.64180332 0.7932296
Soil pH        0.2063019 0.000000000 0.16592353     0.09631980 0.2215670
Dung           0.2681389 0.165923527 0.00000000     0.13257721 0.6396445
% Canopy Cover 0.6418033 0.096319796 0.13257721     0.00000000 0.4629551
alpha          0.7932296 0.221567025 0.63964451     0.46295512 0.0000000
gamma          0.8133355 0.928076961 0.59124991     0.64958277 0.1562502
lambda         0.2980158 0.766103280 0.67530864     0.52923211 0.8848934
A              0.2184458 0.004055233 0.09140009     0.04424332 0.3535944
phi            0.2706357 0.097364069 0.02272540     0.04328636 0.7228378
alpha_gamma    0.5238855 0.026651732 0.15155037     0.03021142 0.1448180
                   gamma    lambda           A        phi alpha_gamma
BareSoil       0.8133355 0.2980158 0.218445820 0.27063571  0.52388546
Soil pH        0.9280770 0.7661033 0.004055233 0.09736407  0.02665173
Dung           0.5912499 0.6753086 0.091400093 0.02272540  0.15155037
% Canopy Cover 0.6495828 0.5292321 0.044243320 0.04328636  0.03021142
alpha          0.1562502 0.8848934 0.353594393 0.72283778  0.14481801
gamma          0.0000000 0.6066543 0.825141985 0.41785775  0.86878719
lambda         0.6066543 0.0000000 0.941464984 0.74863072  0.77923205
A              0.8251420 0.9414650 0.000000000 0.03057112  0.02694868
phi            0.4178577 0.7486307 0.030571115 0.00000000  0.11352938
alpha_gamma    0.8687872 0.7792321 0.026948677 0.11352938  0.00000000</code></pre>
</div>
</div>
<p>Note that these are <code>r</code> values and not <code>$r^2$</code>.</p>
<p>We can do the same for point level data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join site level measures of ecosystem function and environment</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>sout<span class="sc">$</span>SitePoint <span class="ot">&lt;-</span> <span class="fu">rownames</span>(sout)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>point_ef_env <span class="ot">&lt;-</span> <span class="fu">left_join</span>(penv, sout)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot biplots of all combinations of variables</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(point_ef_env[,<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform correlations of all combinations of variables</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.table</span>(point_ef_env[,<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$r
                  BareSoil    Soil pH       Dung % Canopy Cover       alpha
BareSoil        1.00000000  0.4002522  0.4554606   -0.086402836 -0.43729628
Soil pH         0.40025216  1.0000000  0.6914337   -0.665191748 -0.29851259
Dung            0.45546063  0.6914337  1.0000000   -0.569003732 -0.29848883
% Canopy Cover -0.08640284 -0.6651917 -0.5690037    1.000000000  0.05619548
alpha          -0.43729628 -0.2985126 -0.2984888    0.056195483  1.00000000
gamma           0.41328444  0.2077338  0.2401209   -0.001376732 -0.99366394
lambda         -0.01453807 -0.4934031 -0.6115792    0.721184980  0.10938317
A              -0.05823843 -0.5328680 -0.7480129    0.693288926  0.19424282
phi             0.09319161  0.6653218  0.7126024   -0.705412014 -0.24599872
alpha_gamma    -0.31996138 -0.8448857 -0.5719249    0.476797709  0.32260766
                      gamma      lambda           A         phi alpha_gamma
BareSoil        0.413284443 -0.01453807 -0.05823843  0.09319161  -0.3199614
Soil pH         0.207733797 -0.49340310 -0.53286798  0.66532178  -0.8448857
Dung            0.240120867 -0.61157920 -0.74801285  0.71260240  -0.5719249
% Canopy Cover -0.001376732  0.72118498  0.69328893 -0.70541201   0.4767977
alpha          -0.993663936  0.10938317  0.19424282 -0.24599872   0.3226077
gamma           1.000000000 -0.06885737 -0.15184940  0.19669874  -0.2141808
lambda         -0.068857366  1.00000000  0.75997715 -0.76065364   0.3707474
A              -0.151849404  0.75997715  1.00000000 -0.94242005   0.4093241
phi             0.196698742 -0.76065364 -0.94242005  1.00000000  -0.4814242
alpha_gamma    -0.214180799  0.37074742  0.40932408 -0.48142421   1.0000000

$df
[1] 18

$P
                 BareSoil      Soil pH         Dung % Canopy Cover        alpha
BareSoil       0.00000000 8.034541e-02 0.0435860921   0.7172000991 5.384315e-02
Soil pH        0.08034541 0.000000e+00 0.0007339015   0.0013721920 2.011020e-01
Dung           0.04358609 7.339015e-04 0.0000000000   0.0088373599 2.011396e-01
% Canopy Cover 0.71720010 1.372192e-03 0.0088373599   0.0000000000 8.139625e-01
alpha          0.05384315 2.011020e-01 0.2011396065   0.8139624771 0.000000e+00
gamma          0.07010663 3.794887e-01 0.3078578891   0.9954038446 1.527571e-18
lambda         0.95149243 2.705323e-02 0.0041652350   0.0003328406 6.461908e-01
A              0.80731876 1.555879e-02 0.0001492382   0.0007004635 4.118707e-01
phi            0.69595799 1.368145e-03 0.0004222358   0.0005121244 2.958022e-01
alpha_gamma    0.16905409 2.771555e-06 0.0084191996   0.0335391096 1.653587e-01
                      gamma       lambda            A          phi  alpha_gamma
BareSoil       7.010663e-02 0.9514924307 8.073188e-01 6.959580e-01 1.690541e-01
Soil pH        3.794887e-01 0.0270532315 1.555879e-02 1.368145e-03 2.771555e-06
Dung           3.078579e-01 0.0041652350 1.492382e-04 4.222358e-04 8.419200e-03
% Canopy Cover 9.954038e-01 0.0003328406 7.004635e-04 5.121244e-04 3.353911e-02
alpha          1.527571e-18 0.6461908326 4.118707e-01 2.958022e-01 1.653587e-01
gamma          0.000000e+00 0.7729994536 5.227658e-01 4.058672e-01 3.645355e-01
lambda         7.729995e-01 0.0000000000 1.010561e-04 9.878800e-05 1.075658e-01
A              5.227658e-01 0.0001010561 0.000000e+00 5.356282e-10 7.310845e-02
phi            4.058672e-01 0.0000987880 5.356282e-10 0.000000e+00 3.162135e-02
alpha_gamma    3.645355e-01 0.1075657846 7.310845e-02 3.162135e-02 0.000000e+00</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="test-relationship-among-distance-matrices" class="level2">
<h2 class="anchored" data-anchor-id="test-relationship-among-distance-matrices">Test relationship among distance matrices</h2>
<p>When working with measures of beta diversity you are automatically dealing with distance matrices (i.e.&nbsp;the difference between two or more samples) rather than tables of point estimates (i.e site specific measures of biodiversity etc). A major problem with distance matrices is that each sample is represented more than once (usually the total number of samples minus 1) in the distance matrix, which means that the entries in the distance matrix are not independent. This violates a major assumption of most traditional statistics. For example, one cannot apply a linear model to the graph below, because each site is represented multiple times in the points on the graph (e.g.&nbsp;Sandstone vs Sand, Sandstone vs Renosterveld, Standstone vs Grass, etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.dist</span>(msampBFD[<span class="fu">rownames</span>(edis),<span class="fu">colnames</span>(edis)]) <span class="sc">~</span> <span class="fu">as.dist</span>(edis), <span class="at">ylab =</span> <span class="st">"Functional Beta Diversity"</span>, <span class="at">xlab =</span> <span class="st">"Environmental dissimilarity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this case we need to use methods that can explore correlations among distance matrices. Perhaps the most common of these is Mantel’s test, which in this case gives:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mantel</span>(msampBFD[<span class="fu">rownames</span>(edis),<span class="fu">colnames</span>(edis)],edis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mantel statistic based on Pearson's product-moment correlation 

Call:
mantel(xdis = msampBFD[rownames(edis), colnames(edis)], ydis = edis) 

Mantel statistic r: -0.07351 
      Significance: 0.55 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.378 0.472 0.593 0.612 
Permutation: free
Number of permutations: 119</code></pre>
</div>
</div>
</section>
<section id="testing-for-grouping-of-similarity-among-points-within-sites-using-analysis-of-variance-using-distance-matrices-adonis" class="level2">
<h2 class="anchored" data-anchor-id="testing-for-grouping-of-similarity-among-points-within-sites-using-analysis-of-variance-using-distance-matrices-adonis">Testing for grouping of similarity among points within sites using analysis of variance using distance matrices (ADONIS)</h2>
<p>ADONIS was developed to deal with the same issue of non-independence among data points.</p>
<p>This is a somewhat spurious example, because we’d be surprised if the species composition of our point samples weren’t more similar within than between sites, but the method may be handy for other analyses. see <code>?adonis</code> for details.</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split the row names into a dataframe with separate columns for site and point</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>group_var <span class="ot">&lt;-</span> <span class="fu">separate</span>(<span class="fu">as.data.frame</span>(<span class="fu">row.names</span>(point_comm)), <span class="at">col =</span> <span class="dv">1</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"site"</span>, <span class="st">"point"</span>), <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># run adonis analysis and report results</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis2</span>(point_comm <span class="sc">~</span> site, <span class="at">data =</span> group_var, <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method =</span> <span class="st">"bray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Permutation: free
Number of permutations: 999

adonis2(formula = point_comm ~ site, data = group_var, permutations = 999, method = "bray")
         Df SumOfSqs     R2      F Pr(&gt;F)    
Model     4   3.8518 0.6135 5.9525  0.001 ***
Residual 15   2.4266 0.3865                  
Total    19   6.2784 1.0000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Note that the test above calculates the distances from a community data matrix using the specified method fed to the function (“bray” in this case, which is Bray-Curtis distance, but since all abundance values are 1, this is just Sorenson’s coefficient).</p>
<p>You can also feed the function a distance matrix. Here I test whether the environmental dissimilarity of our point samples is greater within than between sites by feeding the function the <code>pedis</code> environmental distance matrix we made earlier. Note that I remake the grouping variable from the names of the distance object to make sure that they align.</p>
<p>R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split the row names into a dataframe with separate columns for site and point</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>group_var_pedis <span class="ot">&lt;-</span> <span class="fu">separate</span>(<span class="fu">as.data.frame</span>(<span class="fu">names</span>(pedis)), <span class="at">col =</span> <span class="dv">1</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"site"</span>, <span class="st">"point"</span>), <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># run adonis analysis and report results</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis2</span>(pedis <span class="sc">~</span> site, <span class="at">data =</span> group_var_pedis, <span class="at">permutations =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Permutation: free
Number of permutations: 999

adonis2(formula = pedis ~ site, data = group_var_pedis, permutations = 999)
         Df SumOfSqs      R2      F Pr(&gt;F)    
Model     4   52.468 0.69037 8.3611  0.001 ***
Residual 15   23.532 0.30963                  
Total    19   76.000 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
<section id="references-papers-accessible-at-this-link" class="level1">
<h1>References (papers accessible <a href="https://paperpile.com/shared/rCBYJb">at this link</a>)</h1>
<p>Bergh, Nicola G., G. A. Verboom, Mathieu Rouget, and Richard M. Cowling. 2014. “Vegetation Types of the Greater Cape Floristic Region.” in Fynbos: Ecology, Evolution, and Conservation of a Megadiverse Region. Allsopp et al.&nbsp;(Eds)</p>
<p>Mucina, Ladislav, Michael C. Rutherford, and Others. 2006. The Vegetation of South Africa, Lesotho and Swaziland. South African National Biodiversity Institute. https://www.cabdirect.org/cabdirect/abstract/20073221934.</p>
<p>Petchey, Owen L., and Kevin J. Gaston. 2002. “Functional Diversity (FD), Species Richness and Community Composition.” Ecology Letters 5 (3): 402–11. https://doi.org/10.1046/j.1461-0248.2002.00339.x.</p>
<p>Plas, Fons van der. 2019. “Biodiversity and Ecosystem Functioning in Naturally Assembled Communities.” Biological Reviews of the Cambridge Philosophical Society 94 (4): 1220–45. https://doi.org/10.1111/brv.12499.</p>
<p>Slingsby, Jasper A., Glenn R. Moncrieff, and Adam M. Wilson. 2020. “Near-Real Time Forecasting and Change Detection for an Open Ecosystem with Complex Natural Dynamics.” ISPRS Journal of Photogrammetry and Remote Sensing. 166 (August): 15–25. https://doi.org/10.1016/j.isprsjprs.2020.05.017.</p>
<p>Wilson, Adam M., Andrew M. Latimer, and John A. Silander Jr.&nbsp;2015. “Climatic Controls on Ecosystem Resilience: Postfire Regeneration in the Cape Floristic Region of South Africa.” Proceedings of the National Academy of Sciences of the United States of America 112 (29): 9058–63. https://doi.org/10.1073/pnas.1416710112.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Made with Quarto. Images copyright. Text CC-BY-4.0. Template CC-0.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>